(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[29],{145:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(116);function c(e,t){return Object(n.a)(e,t,!1)}},433:function(e,t,a){"use strict";a.r(t);var n=a(191),c=a(117),r=a.n(c),o=a(118),s=a(109),i=a(2),l=a(5),d=a(166),b=a.n(d),u=a(145),j=a(193),O=a(121),f=a(108),h=a(52),p=a(287),m=a(291),g=a(424),v=a(435),x=a(135),B=a(300),y=a(453),I=a(153),k=a(122),C=a(148),w=a(149),S=a(13);t.default=function(){var e=Object(l.h)().search,t=b.a.parse(e),a=Object(l.g)(),c=Object(l.i)().param,d=t.id,N=t.category,F=Object(i.useState)(),R=Object(s.a)(F,2),q=R[0],E=R[1],J=Object(i.useState)(),T=Object(s.a)(J,2),U=T[0],_=T[1],z=Object(i.useState)([]),A=Object(s.a)(z,2),D=A[0],L=A[1],G=Object(i.useState)(),H=Object(s.a)(G,2),K=H[0],M=H[1],P=Object(x.a)(""),Q=Object(s.a)(P,3),V=Q[0],W=Q[1],X=Q[2],Y=Object(x.a)(""),Z=Object(s.a)(Y,3),$=Z[0],ee=Z[1],te=Z[2],ae=Object(x.a)(""),ne=Object(s.a)(ae,3),ce=ne[0],re=ne[1],oe=ne[2],se=Object(i.useState)(0),ie=Object(s.a)(se,2),le=ie[0],de=ie[1],be=Object(i.useState)(),ue=Object(s.a)(be,2),je=ue[0],Oe=ue[1],fe=Object(i.useState)(),he=Object(s.a)(fe,2),pe=he[0],me=he[1],ge=Object(i.useState)(!1),ve=Object(s.a)(ge,2),xe=ve[0],Be=ve[1],ye=Object(u.a)(O.b,{variables:{id:parseInt(d,10)}}),Ie=ye.data,ke=ye.loading,Ce=ye.refetch,we=Object(j.a)(f.e,{onCompleted:function(e){var t=e.deleteBoard,n=t.ok,r=t.err;n?(h.b.success("\uac8c\uc2dc\ubb3c\uc774 \uc0ad\uc81c \ub418\uc5c8\uc2b5\ub2c8\ub2e4"),a.push({pathname:"/admin/".concat(c,"/").concat(N),state:{refresh:!0}})):(console.log(r),h.b.error("\uac8c\uc2dc\ubb3c\uc744 \uc0ad\uc81c \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"))}}),Se=Object(s.a)(we,1)[0],Ne=Object(j.a)(f.f,{onCompleted:function(e){var t=e.deleteFile,a=t.ok,n=t.err;a&&(h.b.success("\ud30c\uc77c\uc774 \uc0ad\uc81c \ub418\uc5c8\uc2b5\ub2c8\ub2e4"),Ce?Ce():(console.log(n),h.b.error(n)))}}),Fe=Object(s.a)(Ne,1)[0],Re=Object(j.a)(f.b),qe=Object(s.a)(Re,1)[0],Ee=Object(j.a)(f.c),Je=Object(s.a)(Ee,1)[0],Te=Object(j.a)(f.i,{onCompleted:function(e){var t=e.editBoard,n=t.ok,r=t.err;n?(h.b.success("\uac8c\uc2dc\ubb3c\uc774 \uc218\uc815 \ub418\uc5c8\uc2b5\ub2c8\ub2e4"),a.push({pathname:"/admin/".concat(c,"/").concat(N),state:{refresh:!0}})):(console.log(r),h.b.error("\uac8c\uc2dc\ubb3c\uc744 \uc0ad\uc81c \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"))}}),Ue=Object(s.a)(Te,1)[0],_e=Object(i.useCallback)((function(){Se({variables:{id:parseInt(d,10)}})}),[d,Se]),ze=Object(i.useCallback)(Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue({variables:{id:parseInt(d,10),title:V,content:$,link:ce}});case 2:case"end":return e.stop()}}),e)}))),[d,V,$,ce,Ue]),Ae=Object(i.useCallback)(function(){var e=Object(o.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.a.ref("/files/".concat(N,"/").concat(a)).delete(),e.next=3,Fe({variables:{id:t}});case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[Fe,N]),De=Object(i.useCallback)((function(e){de(le+1),me(e.name),Be(!0),Object(w.a)("images",e,N,e.name,Oe,le,de,Je,parseInt(d,10)),Be(!1),de(0)}),[N,le,Je,d]),Le=Object(i.useCallback)((function(e){Be(!0),de(le+1),k.a.ref("/files/".concat(N,"/").concat(e.name)).put(e).on("state_changed",(function(e){}),(function(e){return console.log(e)}),(function(){k.a.ref("/files/".concat(N,"/").concat(e.name)).getDownloadURL().then(function(){var t=Object(o.a)(r.a.mark((function t(a){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return L((function(t){return[].concat(Object(n.a)(t),[{url:a,fileName:e.name}])})),t.next=3,qe({variables:{url:a,fileName:e.name,boardId:parseInt(d,10)},onCompleted:function(e){var t=e.createFile,a=t.ok,n=t.err;a?(h.b.success("\ud30c\uc77c\uc774 \uc5c5\ub85c\ub4dc \ub418\uc5c8\uc2b5\ub2c8\ub2e4"),Ce&&Ce()):(h.b.error("\ud30c\uc77c \uc5c5\ub85c\ub4dc\uc5d0 \uc2e4\ud328 \ud558\uc600\uc2b5\ub2c8\ub2e4"),console.log(n))}});case 3:Be(!1),de(le-1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}),[qe,d,N,le,Ce]),Ge=Object(i.useCallback)((function(){pe&&pe.trim()&&Object(C.a)("images",N,pe,Oe)}),[N,pe]);return Object(i.useEffect)((function(){Ie&&Ie.getBoardById&&Ie.getBoardById.data&&(E(Ie.getBoardById.data),X(Ie.getBoardById.data.title||""),te(Ie.getBoardById.data.content||""),oe(Ie.getBoardById.data.link||"")),Ie&&Ie.getBoardById&&Ie.getBoardById.data&&Ie.getBoardById.data.files&&_(Ie.getBoardById.data.files),Ie&&Ie.getBoardById&&Ie.getBoardById.data&&Ie.getBoardById.data.images&&M(Ie.getBoardById.data.images)}),[Ie,X,te,oe]),Object(i.useEffect)((function(){le<0&&de(0)}),[le]),ke?Object(S.jsx)("div",{children:"loading..."}):Object(S.jsxs)(p.b,{children:[Object(S.jsx)(p.a,{type:"ghost",onClick:function(){return a.goBack()},children:"\ub4a4\ub85c"}),Object(S.jsxs)(m.b,{bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1},layout:"horizontal",children:[Object(S.jsx)(m.b.Item,{label:"\uc81c\ubaa9",span:4,labelStyle:{width:100},children:Object(S.jsx)(g.a,{placeholder:(null===q||void 0===q?void 0:q.title)||void 0,value:V,onChange:W})}),Object(S.jsxs)(m.b.Item,{label:"\ud30c\uc77c",span:4,labelStyle:{width:100},children:[U&&0!==U.length?Object(S.jsx)(S.Fragment,{children:U.map((function(e,t){return Object(S.jsxs)("div",{className:"attach-group",children:[Object(S.jsx)("a",{href:null===e||void 0===e?void 0:e.url,download:!0,target:"_blank",rel:"noreferrer",children:null===e||void 0===e?void 0:e.fileName}),Object(S.jsx)("button",{className:"attach-button",onClick:function(){return Ae(e.id,e.fileName)},children:Object(S.jsx)(B.a,{})})]},t)}))}):0===D.length?Object(S.jsx)("div",{children:"\ucca8\ubd80\ud30c\uc77c \uc5c6\uc74c"}):Object(S.jsx)(S.Fragment,{}),Object(S.jsx)(v.a,{multiple:!0,maxCount:4,className:"upload-list-inline",customRequest:function(e){var t=e.file;return Le(t)},onChange:function(e){var t=e.file;0!==D.length?t.status="done":t.status="removed"},children:Object(S.jsx)(p.a,{icon:Object(S.jsx)(y.a,{}),children:"\ud30c\uc77c \uc5c5\ub85c\ub4dc"})})]}),Object(S.jsx)(m.b.Item,{label:"\ub9c1\ud06c",span:4,children:Object(S.jsx)(g.a,{placeholder:(null===q||void 0===q?void 0:q.link)||void 0,value:ce,onChange:re})}),"achievement"===c&&Object(S.jsxs)(m.b.Item,{label:"\uc774\ubbf8\uc9c0",span:4,labelStyle:{width:100},children:[K&&0!==K.length?Object(S.jsx)("div",{children:je?Object(S.jsx)("img",{src:je,width:300,alt:"upimage"}):Object(S.jsx)("img",{src:K[0].url,alt:"ima",width:300})}):Object(S.jsx)("div",{children:"\uc774\ubbf8\uc9c0 \uc5c6\uc74c"}),Object(S.jsx)(v.a,{multiple:!0,maxCount:1,listType:"picture",className:"upload-list-inline",progress:{showInfo:!0},onRemove:function(){return Ge()},customRequest:function(e){var t=e.file;return De(t)},onChange:function(e){var t=e.file;0!==D.length?t.status="done":t.status="removed"},children:Object(S.jsx)(p.a,{icon:Object(S.jsx)(y.a,{}),children:"\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc"})})]}),Object(S.jsx)(m.b.Item,{label:"\ub0b4\uc6a9",span:4,children:Object(S.jsx)(g.a.TextArea,{placeholder:(null===q||void 0===q?void 0:q.content)||void 0,rows:10,value:$,onChange:ee})})]}),Object(S.jsxs)("div",{className:"button-group",children:[Object(S.jsx)(p.a,{type:"primary",onClick:function(){return ze()},disabled:xe,children:ke?"Uploading...":Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(I.a,{})," \uc774\ubbf8\uc9c0 / \ud30c\uc77c \uc5c5\ub85c\ub4dc \uc911\uc785\ub2c8\ub2e4..."]})}),Object(S.jsx)(p.a,{type:"primary",danger:!0,onClick:_e,children:"\uc0ad\uc81c\ud558\uae30"})]})]})}}}]);
//# sourceMappingURL=29.a10e611a.chunk.js.map